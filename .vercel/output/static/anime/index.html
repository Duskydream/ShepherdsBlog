<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><title>我的追番</title><link href=/_astro/anime.jx8_zNfG.css rel=stylesheet></head><body class="bg-gray-100 font-sans min-h-screen text-gray-800"><h1 class="font-bold mt-8 text-3xl text-center">📺 我的追番</h1><a class="px-4 mx-auto block mb-6 py-2 rounded-full bg-blue-600 duration-200 font-semibold hover:bg-blue-700 mt-4 text-center text-white transition-colors" href=/ >返回主页 </a><input class="px-4 mx-auto block mb-6 py-2 rounded-full border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-200 max-w-sm outline-none transition w-11/12" id=search placeholder=搜索番剧... type=text><div class="mb-6 flex gap-4 justify-center"><button class="px-4 py-2 rounded-full font-semibold transition bg-blue-600 hover:bg-blue-700 shadow text-white" id=tab-watching>在看</button> <button class="px-4 py-2 rounded-full font-semibold transition bg-gray-200 hover:bg-gray-300 text-gray-700" id=tab-wish>想看</button> <button class="px-4 py-2 rounded-full font-semibold transition bg-gray-200 hover:bg-gray-300 text-gray-700" id=tab-watched>看过</button></div><div id=tab-content><div class="px-4 mx-auto gap-6 grid grid-cols-2 lg:grid-cols-6 max-w-7xl md:grid-cols-4 sm:grid-cols-3" id=content-watching><p>加载中…</p></div><div class="px-4 mx-auto gap-6 grid grid-cols-2 lg:grid-cols-6 max-w-7xl md:grid-cols-4 sm:grid-cols-3 hidden" id=content-wish><p>加载中…</p></div><div class="px-4 mx-auto gap-6 grid grid-cols-2 lg:grid-cols-6 max-w-7xl md:grid-cols-4 sm:grid-cols-3 hidden" id=content-watched><p>加载中…</p></div></div><script type=module>const tabButtons=[document.getElementById("tab-watching"),document.getElementById("tab-wish"),document.getElementById("tab-watched")],tabContents=[document.getElementById("content-watching"),document.getElementById("content-wish"),document.getElementById("content-watched")],searchInput=document.getElementById("search");function filterCards(){const t=searchInput.value.toLowerCase(),e=tabContents.find((t=>!t.classList.contains("hidden")));if(!e)return;e.querySelectorAll(".card").forEach((e=>{const n=e.dataset.name||"";e.classList.toggle("hidden",!n.includes(t))}))}async function fetchCollectionJS(t){let e=1;let n=[];try{for(;;){const a=await fetch(`https://api.bgm.tv/v0/users/851657/collections?type=${t}&limit=30&offset=${30*(e-1)}`,{headers:{"User-Agent":"AstroBlog/1.0 (https://yourblog.com)"}});if(!a.ok)break;const s=await a.json();if(!s.data||0===s.data.length)break;if(n=n.concat(s.data),s.data.length<30)break;e++}}catch(t){console.error(t)}return n}function renderCards(t,e,n){t&&(e&&0!==e.length?t.innerHTML=e.map((t=>`\n          <div class="card bg-white rounded-xl shadow hover:shadow-lg transform hover:-translate-y-1 transition overflow-hidden text-center" \n               data-name="${(t.subject.name_cn||t.subject.name).toLowerCase()}">\n            ${t.subject.images?.common?`<a href="https://bgm.tv/subject/${t.subject.id}" target="_blank">\n              <img src="${t.subject.images.common}" alt="${t.subject.name_cn||t.subject.name}" class="w-full aspect-[3/4] object-cover"/>\n            </a>`:""}\n            <h3 class="mt-2 text-sm font-medium truncate px-2">${t.subject.name_cn||t.subject.name}</h3>\n            ${t.subject.date?`<p class="text-xs text-gray-500 mb-2">${t.subject.date}</p>`:""}\n          </div>\n        `)).join(""):t.innerHTML=`<p class="col-span-full text-center text-gray-500">${n}</p>`)}async function init(){const[t,e,n]=await Promise.all([fetchCollectionJS(3),fetchCollectionJS(1),fetchCollectionJS(2)]);renderCards(tabContents[0],t,"目前没有在看的番剧"),renderCards(tabContents[1],e,"目前没有想看的番剧"),renderCards(tabContents[2],n,"目前没有看过的番剧"),filterCards()}tabButtons.forEach(((t,e)=>{t.addEventListener("click",(()=>{tabButtons.forEach(((t,e)=>{t.classList.remove("bg-blue-600","text-white","shadow"),t.classList.add("bg-gray-200","text-gray-700")})),t.classList.add("bg-blue-600","text-white","shadow"),t.classList.remove("bg-gray-200","text-gray-700"),tabContents.forEach(((t,n)=>t.classList.toggle("hidden",n!==e))),filterCards()}))})),searchInput.addEventListener("input",filterCards),init()</script></body></html>